import urllib.parse
import logging
import traceback
from datetime import datetime

logger = logging.getLogger(__name__)

def clean_url_util(url):
    """Clean and validate URL"""
    try:
        if not url.startswith(('http://', 'https://')):
            url = 'https://' + url
            
        parsed = urllib.parse.urlparse(url)
        return parsed.netloc if parsed.netloc else parsed.path.split('/')[0]
    except Exception as e:
        logger.error(f"Error cleaning URL: {str(e)}")
        logger.error(traceback.format_exc())
        return url